# Elasticsearch Helm Values for DhakaCart
# This configures Elasticsearch for centralized logging

# Cluster settings
clusterName: "dhakacart-logs"
nodeGroup: "master"

# Master nodes configuration
masterService: "dhakacart-elasticsearch-master"
roles:
  master: "true"
  ingest: "true"
  data: "true"
  remote_cluster_client: "true"

# Replica configuration
replicas: 3
minimumMasterNodes: 2

# Resource configuration
resources:
  requests:
    cpu: "1000m"
    memory: "2Gi"
  limits:
    cpu: "2000m"
    memory: "4Gi"

# JVM heap size (should be 50% of memory limit)
esJavaOpts: "-Xmx2g -Xms2g"

# Persistence configuration
persistence:
  enabled: true
  labels:
    enabled: false
  annotations: {}

volumeClaimTemplate:
  accessModes: ["ReadWriteOnce"]
  storageClassName: "gp3"
  resources:
    requests:
      storage: 100Gi

# Security configuration
esConfig:
  elasticsearch.yml: |
    cluster.name: dhakacart-logs
    network.host: 0.0.0.0
    
    # Security settings
    xpack.security.enabled: false
    xpack.security.transport.ssl.enabled: false
    xpack.security.http.ssl.enabled: false
    
    # Performance settings
    indices.memory.index_buffer_size: 10%
    indices.memory.min_index_buffer_size: 48mb
    
    # Index lifecycle management
    xpack.ilm.enabled: true
    
    # Monitoring
    xpack.monitoring.collection.enabled: true

# Service configuration
service:
  enabled: true
  labels: {}
  labelsHeadless: {}
  type: ClusterIP
  nodePort: ""
  annotations: {}
  httpPortName: http
  transportPortName: transport
  loadBalancerIP: ""
  loadBalancerSourceRanges: []
  externalTrafficPolicy: ""

# Network policy
networkPolicy:
  enabled: false

# Pod disruption budget
maxUnavailable: 1

# Pod security context
podSecurityContext:
  fsGroup: 1000
  runAsUser: 1000

# Security context
securityContext:
  capabilities:
    drop:
    - ALL
  runAsNonRoot: true
  runAsUser: 1000

# Lifecycle hooks
lifecycle: {}

# Sysctls
sysctlVmMaxMapCount: 262144

# Readiness probe
readinessProbe:
  failureThreshold: 3
  initialDelaySeconds: 10
  periodSeconds: 10
  successThreshold: 3
  timeoutSeconds: 5

# Cluster health check
clusterHealthCheckParams: "wait_for_status=yellow&timeout=1s"

# Node affinity
nodeAffinity: {}

# Pod affinity
podAffinity: {}

# Pod anti-affinity
podAntiAffinity:
  requiredDuringSchedulingIgnoredDuringExecution:
  - labelSelector:
      matchExpressions:
      - key: app
        operator: In
        values:
        - elasticsearch-master
    topologyKey: kubernetes.io/hostname

# Tolerations
tolerations: []

# Node selector
nodeSelector: {}

# Init containers
initContainers: []

# Extra containers
extraContainers: []

# Extra init containers
extraInitContainers: []

# Priority class
priorityClassName: ""

# Annotations
podAnnotations: {}

# Labels
labels: {}

# Environment variables
extraEnvs: []

# Extra volumes
extraVolumes: []

# Extra volume mounts
extraVolumeMounts: []

# Image pull secrets
imagePullSecrets: []

# Ingress
ingress:
  enabled: false